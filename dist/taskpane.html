<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DeepSeek Chat</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css"><style>:root{--primary-color:#6e6e80;--secondary-color:#acacbe;--bg-color:#f7f7f8;--sidebar-bg:#f0f0f0;--message-bg:#ffffff;--user-message-bg:#f0f0f0;--border-color:#e5e5e6;--button-bg:#10a37f;--button-hover:#0d8a6a;--code-bg:#f6f8fa}*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}body{background-color:var(--bg-color);color:#333;display:flex;height:100vh;overflow:hidden}.sidebar{width:260px;background-color:var(--sidebar-bg);border-right:1px solid var(--border-color);display:flex;flex-direction:column;height:100vh;transition:transform .3s ease}.sidebar-header{padding:15px;border-bottom:1px solid var(--border-color)}.new-chat-btn{width:100%;padding:10px;background-color:var(--button-bg);color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;transition:background-color .2s}.new-chat-btn:hover{background-color:var(--button-hover)}.history-list{flex:1;overflow-y:auto;padding:10px 0}.history-item{padding:10px 15px;cursor:pointer;border-radius:5px;margin:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.history-item:hover{background-color:rgba(0,0,0,.05)}.history-item.active{background-color:rgba(0,0,0,.1)}.sidebar-footer{padding:15px;border-top:1px solid var(--border-color)}.user-profile{display:flex;align-items:center;gap:10px}.user-avatar{width:25px;height:25px;border-radius:50%;background-color:#ddd;display:flex;align-items:center;justify-content:center;font-weight:700}.user-name{font-weight:300}.main-content{flex:1;display:flex;flex-direction:column;height:100vh;position:relative}.chat-header{padding:15px;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between}.chat-title{font-weight:600;font-size:16px}.api-config-btn{background:0 0;border:none;cursor:pointer;color:var(--primary-color);font-size:14px;display:flex;align-items:center;gap:5px}.api-config-btn:hover{color:#000}.messages-container{flex:1;overflow-y:auto;padding:20px 0;scroll-behavior:smooth;display:flex;flex-direction:column;align-items:center}.message{width:85%;max-width:800px;margin-left:0;margin-right:0;box-sizing:border-box}.avatar{width:25px;height:25px;border-radius:50%;background-color:#10a37f;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;flex-shrink:0}.user-avatar{background-color:#6e6e80}.message-content{flex:1;padding-top:5px}.message-role{font-weight:600;margin-bottom:5px}.message-text{line-height:1.6}.message-text p{margin-bottom:1em}.message-text p:last-child{margin-bottom:0}.message-text{background:#fafbfc;border-radius:6px;padding:16px 18px;margin:8px 0;line-height:1.7;word-break:break-word;font-size:15px;box-sizing:border-box}pre,pre code{white-space:pre-wrap!important;word-break:break-all;overflow-x:hidden!important;margin:0;padding:16px;background-color:var(--code-bg);border-radius:6px}.code-block{margin:10px 0 20px 0;background:var(--code-bg);border-radius:6px;overflow:hidden;box-shadow:0 1px 4px rgba(0,0,0,.03);padding:0}.code-header{width:100%;display:flex;justify-content:space-between;align-items:center;font-family:monospace;font-size:14px;color:#666;background:#f0f0f0;padding:0 16px;height:36px;border-bottom:1px solid #e5e5e6;box-sizing:border-box;margin:0}.code-block pre,.code-block pre code{margin:0;padding:16px;background:0 0;border-radius:0;white-space:pre-wrap!important;word-break:break-all;overflow-x:auto;font-size:15px;box-sizing:border-box}.code-block pre{margin:0;padding:16px;background:0 0;border-radius:0 0 6px 6px}.code-actions{display:flex;gap:4px;margin:0}.code-action-btn{background:0 0;border:none;color:#666;cursor:pointer;font-size:13px;padding:2px 8px;border-radius:4px;margin:0;transition:background .2s,color .2s}.code-action-btn.copy:hover{color:var(--button-bg);background:#e0f7f0}.code-action-btn.run:hover{color:#007bff;background:#e6f0fa}.message-text p:last-child{margin-bottom:0}.input-container{padding:20px;border-top:1px solid var(--border-color);background-color:var(--message-bg)}.input-box{max-width:800px;margin:0 auto;position:relative}.textarea-container{position:relative}.message-input{border-bottom-width:0!important;width:100%;min-height:70px;max-height:200px;padding:12px 50px 12px 15px;border:1px solid var(--border-color);border-radius:8px;resize:none;font-size:15px;line-height:1.5;outline:0;background-color:var(--message-bg);color:#333;transition:border-color .3s ease,box-shadow .3s ease}.message-input:focus{border-color:transparent!important;box-shadow:0 0 0 2px rgba(16,163,127,.1)}.input-actions{position:absolute;right:10px;bottom:10px;display:flex;gap:8px}.file-upload-btn,.send-btn{width:32px;height:32px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background-color:var(--button-bg);color:#fff;transition:background-color .2s}.file-upload-btn{background-color:transparent;color:var(--primary-color)}.file-upload-btn:hover{background-color:rgba(0,0,0,.05)}.send-btn:hover{background-color:var(--button-hover)}.send-btn:disabled{background-color:var(--secondary-color);cursor:not-allowed}.send-btn{width:40px;height:40px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--button-bg) 60%,#13c296 100%);color:#fff;font-size:18px;transition:background .2s,box-shadow .2s,transform .1s;box-shadow:0 2px 8px rgba(16,163,127,.1);outline:0}.send-btn:enabled:hover{background:linear-gradient(135deg,var(--button-hover) 60%,#13c296 100%);box-shadow:0 4px 16px rgba(16,163,127,.18);transform:translateY(-2px) scale(1.07)}.send-btn:enabled:active{background:linear-gradient(135deg,var(--button-bg) 60%,#13c296 100%);box-shadow:0 2px 8px rgba(16,163,127,.1);transform:scale(.97)}.send-btn:disabled svg{color:#acacbe}.send-btn:disabled{background:0 0;color:var(--secondary-color);cursor:not-allowed;opacity:.5;transform:none;box-shadow:none}.send-btn{width:32px;height:32px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background:0 0;color:var(--button-bg);font-size:18px;transition:transform .2s;padding:0;outline:0}.send-btn:enabled:hover{transform:translateX(2px);color:var(--button-hover)}.send-btn:enabled:active{transform:scale(.95)}.send-btn:disabled{color:var(--secondary-color);cursor:not-allowed;opacity:.7}.send-btn svg{width:24px;height:24px}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .3s}.modal-overlay.active{opacity:1;pointer-events:all}.modal{background-color:#fff;border-radius:8px;width:500px;max-width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 4px 20px rgba(0,0,0,.15);transform:translateY(20px);transition:transform .3s}.modal-overlay.active .modal{transform:translateY(0)}.modal-header{padding:16px 20px;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between}.modal-title{font-weight:600;font-size:18px}.modal-close-btn{background:0 0;border:none;font-size:20px;cursor:pointer;color:var(--secondary-color)}.modal-body{padding:20px}.form-group{margin-bottom:20px}.form-label{display:block;margin-bottom:8px;font-weight:500}.form-input{width:100%;padding:10px 12px;border:1px solid var(--border-color);border-radius:4px;font-size:14px}.form-input:focus{border-color:var(--button-bg);outline:0;box-shadow:0 0 0 2px rgba(16,163,127,.2)}.modal-footer{padding:16px 20px;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:10px}.btn{padding:8px 16px;border-radius:4px;font-weight:500;cursor:pointer;transition:background-color .2s}.btn-primary{background-color:var(--button-bg);color:#fff;border:none}.btn-primary:hover{background-color:var(--button-hover)}.btn-secondary{background-color:transparent;border:1px solid var(--border-color)}.btn-secondary:hover{background-color:rgba(0,0,0,.05)}.typing-cursor{display:inline-block;width:8px;height:16px;background-color:#333;vertical-align:middle;margin-left:2px;animation:blink 1s infinite}@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}.file-input{display:none}.attached-files{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px}.file-tag{background-color:#e9e9eb;padding:6px 12px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:8px;max-width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-tag.error{background-color:#fee2e2;color:#dc3545}.html-preview-modal{position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff;z-index:1001;display:none;flex-direction:column}.html-preview-modal.active{display:flex}.preview-header{padding:12px 20px;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center}.preview-title{font-weight:600}.preview-close{background:0 0;border:none;font-size:20px;cursor:pointer}.preview-content{flex:1;border:none;width:100%}@media (max-width:768px){.sidebar{position:absolute;z-index:100;transform:translateX(-100%)}.sidebar.active{transform:translateX(0)}.message{max-width:100%}}@media (max-width:900px){.message{max-width:98vw}}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:rgba(0,0,0,.05)}::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2);border-radius:4px}::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.3)}.messages-container::-webkit-scrollbar,pre code::-webkit-scrollbar,pre::-webkit-scrollbar{height:0!important;width:8px}pre,pre code{scrollbar-width:thin;scrollbar-color:#e5e5e6 #f6f8fa}.context-btn-container{position:absolute;left:8px;bottom:10px;z-index:2;display:flex;align-items:flex-end}.context-eye-btn{width:30px;height:30px;border-radius:50%;border:none;background:0 0;color:var(--secondary-color);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:color .2s,transform .2s;padding:0;outline:0}.context-eye-btn:hover{color:var(--primary-color);transform:scale(1.08);background:0 0}.python-result{margin-top:10px;padding:10px;background:#f8f9fa;border-radius:4px;border-left:4px solid #10a37f}.python-result.error{border-left-color:#dc3545}.python-result.loading{border-left-color:#ffc107;animation:pulse 1.5s infinite}@keyframes pulse{0%{opacity:.6}50%{opacity:1}100%{opacity:.6}}.message-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:8px}.msg-action-btn{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:50%;transition:background .2s;display:inline-flex;align-items:center;justify-content:center}.msg-action-btn:hover{background:#e0f7f0}.msg-action-btn.insert-btn:focus svg path,.msg-action-btn.insert-btn:hover svg path{stroke:#13c296}.msg-action-btn.copy-btn:focus svg rect,.msg-action-btn.copy-btn:hover svg rect{stroke:#10a37f}.textarea-container{position:relative;margin-bottom:0}.gradient-bar{position:absolute;bottom:0;left:0;width:100%;height:5px;background:linear-gradient(to right,#00ff87,#0fe,#00a8ff,#9f5afd,#ff2d95,#00ff87);background-size:200% 100%;opacity:.8;transform:scaleX(1);transform-origin:left;transition:opacity .3s ease;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.gradient-bar.loading{transform:scaleX(1);animation:gradientSlide .8s linear infinite}@keyframes gradientSlide{0%{background-position:100% 0}100%{background-position:-100% 0}}.code-action-btn.run-js:hover{color:#0078d4;background:#e5f1fb}.code-action-btn.run-js{margin-left:4px}.prompt-container{position:relative;margin-bottom:10px}.prompt-toggle-btn{display:flex;align-items:center;gap:6px;padding:6px 12px;border:1px solid var(--border-color);border-radius:6px;background:#fff;color:var(--primary-color);cursor:pointer;font-size:14px;transition:all .2s}.prompt-toggle-btn:hover{background:var(--bg-color);border-color:var(--primary-color)}.prompt-list{position:absolute;bottom:100%;left:0;width:100%;max-height:0;overflow:hidden;background:#fff;border-radius:8px;box-shadow:0 -4px 20px rgba(0,0,0,.1);transition:all .3s ease;z-index:100}.prompt-list.active{max-height:400px;padding:16px;margin-bottom:8px;overflow-y:auto}.prompt-category{margin-bottom:16px}.prompt-category h3{font-size:14px;color:var(--primary-color);margin-bottom:8px;font-weight:600}.prompt-items{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px}.prompt-item{padding:8px 12px;background:var(--bg-color);border:1px solid var(--border-color);border-radius:4px;font-size:13px;color:var(--primary-color);cursor:pointer;text-align:left;transition:all .2s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.prompt-item:hover{background:#f0f0f0;border-color:var(--primary-color)}</style><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script><script src="https://unpkg.com/@jupyterlab/services@6.4.4/dist/index.umd.js"></script><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><div class="sidebar"><div class="sidebar-header"><button class="new-chat-btn" id="newChatBtn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 4V20M4 12H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg> 新聊天</button></div><div class="history-list" id="historyList"></div><div class="sidebar-footer"><div class="user-profile"><div class="user-avatar">U</div><div class="user-name"></div></div></div></div><div class="main-content"><div class="chat-header"><div class="chat-title" id="chatTitle">新聊天</div><button class="api-config-btn" id="apiConfigBtn">⚙️ API 配置</button></div><div class="messages-container" id="messagesContainer"></div><div class="prompt-container"><button class="prompt-toggle-btn" id="promptToggleBtn" title="提示词列表"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke-width="2"/></svg> 提示词</button><div class="prompt-list" id="promptList"><div class="prompt-category"><h3>常用提示词</h3><div class="prompt-items"><button class="prompt-item">帮我修改这段代码的错误</button> <button class="prompt-item">解释这段代码的功能</button> <button class="prompt-item">优化这段代码的性能</button> <button class="prompt-item">帮我生成单元测试</button></div></div><div class="prompt-category"><h3>文档处理</h3><div class="prompt-items"><button class="prompt-item">分析这份文档的主要内容</button> <button class="prompt-item">总结这份文档的要点</button> <button class="prompt-item">检查文档的错误</button> <button class="prompt-item">根据当前工作表数据用Office.js在新的工作表......，要求：优先使用传统的 Promise 链式写法替代 async/await</button></div></div></div></div><div class="input-container"><div class="input-box"><div class="textarea-container"><div class="context-btn-container"><button class="context-eye-btn" id="contextEyeBtn" title="开启上下文感知"><svg id="eyeIcon" width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M1 12C2.73 7.61 7.11 4 12 4s9.27 3.61 11 8c-1.73 4.39-6.11 8-11 8S2.73 16.39 1 12z" stroke="currentColor" stroke-width="2" fill="none"/><circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" fill="none"/><line x1="4" y1="20" x2="20" y2="4" stroke="currentColor" stroke-width="2"/></svg></button></div><textarea class="message-input" id="messageInput" placeholder="输入消息..." rows="1"></textarea><div class="gradient-bar" id="gradientBar"></div><div class="input-actions"><label for="fileUpload" class="file-upload-btn" title="上传文件"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l8.57-8.57A4 4 0 1118.54 9.4l-8.57 8.57a2 2 0 11-2.83-2.83l8.49-8.48" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></label> <input type="file" id="fileUpload" class="file-input" multiple="multiple"> <button class="send-btn" id="sendBtn" disabled="disabled" title="发送"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg></button></div></div><div class="attached-files" id="attachedFiles"></div></div></div></div><div class="modal-overlay" id="apiConfigModal"><div class="modal"><div class="modal-header"><div class="modal-title">✏️API 配置</div><button class="modal-close-btn" id="closeApiConfigModal">&times;</button></div><div class="modal-body"><div class="form-group"><label class="form-label" for="apiKey">API 密钥</label> <input type="password" class="form-input" id="apiKey" placeholder="输入您的API密钥"></div><div class="form-group"><label class="form-label" for="apiEndpoint">API 端点</label> <input class="form-input" id="apiEndpoint" placeholder="https://api.siliconflow.cn/v1/chat/completions"></div><div class="form-group"><label class="form-label" for="model">模型</label> <select class="form-input" id="model"><option value="deepseek-ai/DeepSeek-V3">DeepSeek V3</option><option value="deepseek-ai/DeepSeek-R1">DeepSeek R1</option><option value="Pro/deepseek-ai/DeepSeek-V3">Pro/DeepSeek-V3</option><option value="Pro/deepseek-ai/DeepSeek-R1">Pro/DeepSeek R1</option><option value="Qwen/Qwen3-32B">Qwen/Qwen3-32B</option><option value="Qwen/Qwen3-14B">Qwen/Qwen3-14B</option></select></div><div class="form-group"><label class="form-label" for="temperature">温度 (0-2)</label> <input type="range" class="form-input" id="temperature" min="0" max="2" step="0.1" value="0.7"> <span id="temperatureValue">0.7</span></div></div><div class="modal-footer"><button class="btn btn-secondary" id="cancelApiConfig">取消</button> <button class="btn btn-primary" id="saveApiConfig">保存</button></div></div></div><div class="html-preview-modal" id="htmlPreviewModal"><div class="preview-header"><div class="preview-title">HTML 预览</div><button class="preview-close" id="closePreviewModal">&times;</button></div><iframe class="preview-content" id="htmlPreviewFrame"></iframe></div><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/html.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="40ebd41e946788d8f84f.js"></script></body></html>