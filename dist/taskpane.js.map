{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","        // 1. 全局定义获取上下文函数\n        async function getContextInfo() {\n            if (window.Office && Office.context && Office.context.host) {\n                // Excel\n                if (Office.context.host === Office.HostType.Excel && typeof Excel !== \"undefined\") {\n                    try {\n                        return await Excel.run(async context => {\n                            const sheet = context.workbook.worksheets.getActiveWorksheet();\n                            sheet.load(\"name\");\n                            context.workbook.load(\"name\");\n                            const usedRange = sheet.getUsedRange();\n                            usedRange.load(\"address, rowCount, columnCount, values\");\n                            await context.sync();\n                            const sheetName = sheet.name;\n                            const workbookName = context.workbook.name;\n                            return `工作簿: ${workbookName}\\n工作表: ${sheetName}\\n工作表已用范围：${usedRange.address}\\n工作表已用范围的行数：${usedRange.rowCount}\\n工作表已用范围的列数：${usedRange.columnCount}\\n内容:\\n${JSON.stringify(usedRange.values)}`;\n                        });\n                    } catch (e) {\n                        return `【Excel上下文获取失败】：${e && e.message ? e.message : e}`;\n                    }\n                }\n                // Word\n                if (Office.context.host === Office.HostType.Word && typeof Word !== \"undefined\") {\n                    try {\n                        return await Word.run(async context => {\n                            const selection = context.document.getSelection();\n                            selection.load(\"text\");\n                            await context.sync();\n                            return `Word选中内容: ${selection.text}`;\n                        });\n                    } catch (e) {\n                        return `【Word上下文获取失败】：${e && e.message ? e.message : e}`;\n                    }\n                }\n                return \"【暂不支持的 Office Host】\";\n            } else {\n                // 非 Office 环境，返回模拟内容\n                return \"【模拟上下文】工作簿: 示例.xlsx\\n工作表: Sheet1\\n内容: A1:Hello, B1:World\";\n            }\n        }\n\n        // 2. Office.js 初始化\n        if (window.Office) {\n            Office.onReady(function(info) {\n                console.log('Office.js 已初始化，Host:', info.host);\n                // 这里可以做 Office 相关初始化\n            });\n        }\n\n        // 3. 页面初始化\n        document.addEventListener('DOMContentLoaded', function() {\n            // 初始化代码高亮\n            hljs.highlightAll();\n            \n            // DOM 元素\n            const messageInput = document.getElementById('messageInput');\n            const sendBtn = document.getElementById('sendBtn');\n            const fileUpload = document.getElementById('fileUpload');\n            const attachedFiles = document.getElementById('attachedFiles');\n            const messagesContainer = document.getElementById('messagesContainer');\n            const apiConfigBtn = document.getElementById('apiConfigBtn');\n            const apiConfigModal = document.getElementById('apiConfigModal');\n            const closeApiConfigModal = document.getElementById('closeApiConfigModal');\n            const cancelApiConfig = document.getElementById('cancelApiConfig');\n            const saveApiConfig = document.getElementById('saveApiConfig');\n            const temperature = document.getElementById('temperature');\n            const temperatureValue = document.getElementById('temperatureValue');\n            const newChatBtn = document.getElementById('newChatBtn');\n            const historyList = document.getElementById('historyList');\n            const chatTitle = document.getElementById('chatTitle');\n            const closePreviewModal = document.getElementById('closePreviewModal');\n            const htmlPreviewModal = document.getElementById('htmlPreviewModal');\n                        // 在 DOMContentLoaded 事件监听器内添加\n            const promptToggleBtn = document.getElementById('promptToggleBtn');\n            const promptList = document.getElementById('promptList');\n            \n            // 切换提示词列表的显示/隐藏\n            promptToggleBtn.addEventListener('click', () => {\n                promptList.classList.toggle('active');\n            });\n            \n            // 点击提示词时将其添加到输入框\n            document.querySelectorAll('.prompt-item').forEach(item => {\n                item.addEventListener('click', () => {\n                    const prompt = item.textContent;\n                    messageInput.value = prompt;\n                    messageInput.style.height = 'auto';\n                    messageInput.style.height = messageInput.scrollHeight + 'px';\n                    promptList.classList.remove('active');\n                    sendBtn.disabled = false;\n                    messageInput.focus();\n                });\n            });\n            \n            // 点击其他区域时关闭提示词列表\n            document.addEventListener('click', (e) => {\n                if (!promptList.contains(e.target) && !promptToggleBtn.contains(e.target)) {\n                    promptList.classList.remove('active');\n                }\n            });\n            // 当前聊天ID和消息历史\n            let currentChatId = generateChatId();\n            let chatHistory = {};\n            \n            // 初始化聊天历史\n            initChatHistory();\n            \n            // 自动调整文本区域高度\n            messageInput.addEventListener('input', function() {\n                this.style.height = 'auto';\n                this.style.height = (this.scrollHeight) + 'px';\n            });\n            \n            // 启用/禁用发送按钮\n            messageInput.addEventListener('input', function() {\n                sendBtn.disabled = this.value.trim() === '';\n            });\n            \n            // 文件上传处理\n            fileUpload.addEventListener('change', async function () {\n                attachedFiles.innerHTML = '';\n                let fileContents = [];\n            \n                if (this.files.length > 0) {\n                    // 添加加载提示\n                    const loadingTag = document.createElement('div');\n                    loadingTag.className = 'file-tag';\n                    loadingTag.textContent = '正在读取文件...';\n                    attachedFiles.appendChild(loadingTag);\n            \n                    try {\n                        for (const file of this.files) {\n                            // 创建文件标签\n                            const fileTag = document.createElement('div');\n                            fileTag.className = 'file-tag';\n                            fileTag.innerHTML = `\n                                ${file.name} \n                                <span class=\"remove-file\" data-file-name=\"${file.name}\">&times;</span>\n                            `;\n                            \n                            // 读取文件内容\n                            const content = await readFileContent(file);\n                            \n                            // 如果是Word文档，进行额外处理\n                            if (file.type.includes('word') || file.name.endsWith('.docx') || file.name.endsWith('.doc')) {\n                                fileContents.push({ \n                                    name: file.name, \n                                    content: `### Word文档内容：\\n\\n${content}`\n                                });\n                            } else {\n                                fileContents.push({ name: file.name, content });\n                            }\n                            \n                            // 替换加载提示为实际文件标签\n                            if (loadingTag) {\n                                attachedFiles.removeChild(loadingTag);\n                            }\n                            attachedFiles.appendChild(fileTag);\n                        }\n            \n                        // 将文件内容存储到全局变量 contextInfo 中\n                        contextInfo = fileContents.map(file => \n                            `文件名: ${file.name}\\n内容:\\n${file.content}`\n                        ).join('\\n\\n');\n            \n                    } catch (error) {\n                        // 显示错误提示\n                        if (loadingTag) {\n                            loadingTag.textContent = `文件读取失败: ${error.message}`;\n                            loadingTag.style.color = '#dc3545';\n                        }\n                    }\n                }\n            });\n            \n            // 修改readFileContent函数来支持Word文件\n            function readFileContent(file) {\n                return new Promise((resolve, reject) => {\n                    // 检查文件类型\n                    if (file.type.includes('excel') || file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {\n                        // Excel文件处理...\n                        const reader = new FileReader();\n                        reader.onload = async (e) => {\n                            try {\n                                const data = new Uint8Array(e.target.result);\n                                const workbook = XLSX.read(data, {type: 'array'});\n                                let result = '';\n                                workbook.SheetNames.forEach(sheetName => {\n                                    const worksheet = workbook.Sheets[sheetName];\n                                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});\n                                    result += `工作表: ${sheetName}\\n`;\n                                    result += jsonData.map(row => row.join('\\t')).join('\\n');\n                                    result += '\\n\\n';\n                                });\n                                resolve(result);\n                            } catch (error) {\n                                reject(`Excel文件读取失败: ${error.message}`);\n                            }\n                        };\n                        reader.onerror = () => reject('文件读取失败');\n                        reader.readAsArrayBuffer(file);\n                    } \n                    // 添加Word文件处理\n                    else if (file.type.includes('word') || file.name.endsWith('.docx') || file.name.endsWith('.doc')) {\n                        const reader = new FileReader();\n                        reader.onload = async (e) => {\n                            try {\n                                const arrayBuffer = e.target.result;\n                                \n                                // 检查mammoth.js是否正确加载\n                                if (typeof mammoth === 'undefined') {\n                                    throw new Error('Mammoth.js库未加载');\n                                }\n\n                                // 根据文件类型选择不同的处理方式\n                                let extractedText;\n                                if (file.name.endsWith('.docx')) {\n                                    // 处理.docx文件\n                                    const result = await mammoth.extractRawText({arrayBuffer: arrayBuffer});\n                                    if (!result || !result.value) {\n                                        throw new Error('无法提取DOCX文件内容');\n                                    }\n                                    extractedText = result.value;\n                                } else if (file.name.endsWith('.doc')) {\n                                    // 处理.doc文件\n                                    throw new Error('暂不支持旧版.doc格式，请转换为.docx格式');\n                                } else {\n                                    throw new Error('不支持的Word文档格式');\n                                }\n\n                                // 格式化提取的文本\n                                const formattedText = extractedText\n                                    .trim()\n                                    .replace(/\\r\\n/g, '\\n')    // 统一换行符\n                                    .replace(/\\n{3,}/g, '\\n\\n') // 移除多余空行\n                                    .replace(/\\t+/g, ' ');      // 替换制表符\n\n                                // 添加文档信息头\n                                const documentInfo = `### Word文档：${file.name}\\n\\n${formattedText}`;\n                                \n                                resolve(documentInfo);\n\n                            } catch (error) {\n                                reject(`Word文件读取失败: ${error.message}`);\n                            }\n                        };\n\n                        reader.onerror = () => reject('文件读取失败');\n                        reader.readAsArrayBuffer(file);\n                    }\n                    else {\n                        // 普通文本文件处理\n                        const reader = new FileReader();\n                        reader.onload = () => resolve(reader.result);\n                        reader.onerror = () => reject('文件读取失败');\n                        reader.readAsText(file);\n                    }\n                });\n            }\n            \n            // 移除文件\n            attachedFiles.addEventListener('click', function(e) {\n                if (e.target.classList.contains('remove-file')) {\n                    const fileName = e.target.getAttribute('data-file-name');\n                    const files = Array.from(fileUpload.files).filter(f => f.name !== fileName);\n                    \n                    // 创建一个新的DataTransfer对象来保存剩余的文件\n                    const dataTransfer = new DataTransfer();\n                    files.forEach(file => dataTransfer.items.add(file));\n                    \n                    // 更新文件输入\n                    fileUpload.files = dataTransfer.files;\n                    \n                    // 移除文件标签\n                    e.target.parentElement.remove();\n                }\n            });\n            \n            // API 配置模态框\n            apiConfigBtn.addEventListener('click', function() {\n                apiConfigModal.classList.add('active');\n            });\n            \n            closeApiConfigModal.addEventListener('click', function() {\n                apiConfigModal.classList.remove('active');\n            });\n            \n            cancelApiConfig.addEventListener('click', function() {\n                apiConfigModal.classList.remove('active');\n            });\n            \n            // 温度滑块值显示\n            temperature.addEventListener('input', function() {\n                temperatureValue.textContent = this.value;\n            });\n            \n            // 保存API配置\n            saveApiConfig.addEventListener('click', function() {\n                const apiKey = document.getElementById('apiKey').value;\n                const apiEndpoint = document.getElementById('apiEndpoint').value;\n                const model = document.getElementById('model').value;\n                const temp = temperature.value;\n                \n                if (!apiKey) {\n                    showNotification('请输入API密钥', 'error');\n                    return;\n                }\n                \n                // 保存配置到localStorage\n                localStorage.setItem('apiKey', apiKey || 'sk-kkmlqfpwanpqbfnbmyznssseikhadqzpugtizibnjmdmseus');\n                localStorage.setItem('apiEndpoint', apiEndpoint || 'https://api.siliconflow.cn/v1/chat/completions');\n                localStorage.setItem('model', model || 'deepseek-ai/DeepSeek-V3');\n                localStorage.setItem('temperature', temp || '0.7');\n                \n                apiConfigModal.classList.remove('active');\n                showNotification('API配置已保存');\n            });\n            \n            // 加载保存的配置\n            if (localStorage.getItem('apiKey')) {\n                document.getElementById('apiKey').value = localStorage.getItem('apiKey') || 'sk-kkmlqfpwanpqbfnbmyznssseikhadqzpugtizibnjmdmseus';\n                document.getElementById('apiEndpoint').value = localStorage.getItem('apiEndpoint') || 'https://api.siliconflow.cn/v1/chat/completions';\n                document.getElementById('model').value = localStorage.getItem('model') || 'deepseek-chat';\n                temperature.value = localStorage.getItem('temperature') || '0.7';\n                temperatureValue.textContent = temperature.value;\n            }\n            \n            // 复制代码按钮\n            messagesContainer.addEventListener('click', function(e) {\n                // 复制按钮\n                if (e.target.classList.contains('copy')) {\n                    const codeBlock = e.target.closest('.code-block').querySelector('code');\n                    navigator.clipboard.writeText(codeBlock.textContent).then(() => {\n                        const originalText = e.target.textContent;\n                        e.target.textContent = '已复制!';\n                        setTimeout(() => {\n                            e.target.textContent = originalText;\n                        }, 2000);\n                    });\n                    e.stopPropagation();\n                    return;\n                }\n\n                // 运行HTML按钮\n                if (e.target.classList.contains('run')) {\n                    const codeBlock = e.target.closest('.code-block').querySelector('code');\n                    const htmlPreviewFrame = document.getElementById('htmlPreviewFrame');\n                    // 将HTML代码写入iframe\n                    const blob = new Blob([codeBlock.textContent], { type: 'text/html' });\n                    htmlPreviewFrame.src = URL.createObjectURL(blob);\n                    // 显示预览模态框\n                    document.getElementById('htmlPreviewModal').classList.add('active');\n                    e.stopPropagation();\n                    return;\n                }\n                \n                // 运行Python代码\n                if (e.target.classList.contains('run-python')) {\n                    const codeBlock = e.target.closest('.code-block').querySelector('code');\n                    const pythonCode = codeBlock.textContent;\n                    runPythonCode(pythonCode, e.target.closest('.message-content'));\n                    e.stopPropagation();\n                    return;\n                }\n                // 运行 Office.js 代码\n                if (e.target.classList.contains('run-js')) {\n                    const codeBlock = e.target.closest('.code-block').querySelector('code');\n                    const jsCode = codeBlock.textContent;\n                    runOfficeJSCode(jsCode, e.target.closest('.message-content'));\n                    e.stopPropagation();\n                    return;\n                }\n            });\n            \n            // 关闭HTML预览\n            document.getElementById('closePreviewModal').addEventListener('click', function() {\n                document.getElementById('htmlPreviewModal').classList.remove('active');\n            });\n            \n            // 发送消息\n            sendBtn.addEventListener('click', sendMessage);\n            messageInput.addEventListener('keydown', function(e) {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    sendMessage();\n                }\n            });\n            \n            // 新聊天按钮\n            newChatBtn.addEventListener('click', function() {\n                // 保存当前聊天\n                saveCurrentChat();\n                \n                // 创建新聊天\n                currentChatId = generateChatId();\n                chatTitle.textContent = '新聊天';\n                messagesContainer.innerHTML = '';\n                \n                // 更新历史列表\n                updateHistoryList();\n            });\n            \n            // 初始化聊天历史\n            function initChatHistory() {\n                const savedHistory = localStorage.getItem('chatHistory');\n                if (savedHistory) {\n                    chatHistory = JSON.parse(savedHistory);\n                    updateHistoryList();\n                    \n                    // 如果有历史记录，加载最后一个聊天\n                    const chatIds = Object.keys(chatHistory);\n                    if (chatIds.length > 0) {\n                        currentChatId = chatIds[chatIds.length - 1];\n                        loadChat(currentChatId);\n                    }\n                } else {\n                    chatHistory = {};\n                }\n            }\n            \n            // 生成聊天ID\n            function generateChatId() {\n                return 'chat-' + Date.now();\n            }\n            \n            // 更新历史列表\n            function updateHistoryList() {\n                historyList.innerHTML = '';\n                const chatIds = Object.keys(chatHistory).reverse(); // 最新的在前面\n                \n                chatIds.forEach(chatId => {\n                    const chat = chatHistory[chatId];\n                    const historyItem = document.createElement('div');\n                    historyItem.className = `history-item ${chatId === currentChatId ? 'active' : ''}`;\n                    historyItem.textContent = chat.title || '未命名聊天';\n                    historyItem.addEventListener('click', () => {\n                        // 保存当前聊天\n                        saveCurrentChat();\n                        \n                        // 加载选中的聊天\n                        currentChatId = chatId;\n                        loadChat(chatId);\n                        \n                        // 更新活动状态\n                        document.querySelectorAll('.history-item').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                        historyItem.classList.add('active');\n                    });\n                    historyList.appendChild(historyItem);\n                });\n            }\n            \n            // 保存当前聊天\n            function saveCurrentChat() {\n                const messages = Array.from(messagesContainer.querySelectorAll('.message')).map(message => {\n                    const role = message.querySelector('.message-role').textContent;\n                    const content = message.querySelector('.message-text').innerHTML;\n                    return { role, content };\n                });\n                \n                if (messages.length > 0) {\n                    const title = messages[0].content.replace(/<[^>]*>/g, '').substring(0, 30);\n                    chatHistory[currentChatId] = {\n                        title,\n                        messages\n                    };\n                    \n                    // 保存到localStorage\n                    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));\n                    \n                    // 更新标题\n                    chatTitle.textContent = title;\n                    \n                    // 更新历史列表\n                    updateHistoryList();\n                }\n            }\n            \n            // 加载聊天\n            function loadChat(chatId) {\n                const chat = chatHistory[chatId];\n                if (chat) {\n                    messagesContainer.innerHTML = '';\n                    chatTitle.textContent = chat.title;\n                    \n                    chat.messages.forEach(msg => {\n                        const messageDiv = document.createElement('div');\n                        messageDiv.className = 'message';\n                        \n                        if (msg.role === '用户') {\n                            messageDiv.innerHTML = `\n                                <div class=\"avatar user-avatar\">U</div>\n                                <div class=\"message-content\">\n                                    <div class=\"message-role\">用户</div>\n                                    <div class=\"message-text\">${msg.content}</div>\n                                </div>\n                            `;\n                        } else {\n                            messageDiv.innerHTML = `\n                                <div class=\"avatar\">AI</div>\n                                <div class=\"message-content\">\n                                    <div class=\"message-role\">DeepSeek</div>\n                                    <div class=\"message-text\">${msg.content}</div>\n                                </div>\n                            `;\n                        }\n                        \n                        messagesContainer.appendChild(messageDiv);\n                    });\n                    \n                    // 滚动到底部\n                    scrollToBottom();\n                    \n                    // 重新高亮代码\n                    document.querySelectorAll('pre code').forEach((block) => {\n                        hljs.highlightElement(block);\n                    });\n                }\n            }\n            \n            // 发送消息函数\n            async function sendMessage() {\n                let message = messageInput.value.trim();\n                if (!message) return;\n            \n                // 激活渐变条加载动画\n                const gradientBar = document.getElementById('gradientBar');\n                gradientBar.classList.add('loading');\n            \n                // 保存原始用户消息用于显示\n                const userMessage = message;\n            \n                // 收集对话历史和上下文 \n                const messages = [];\n                \n                // 处理上下文信息\n                if (contextEnabled) {\n                    // 如果有上传的文件内容\n                    if (contextInfo) {\n                        const truncatedFileContent = contextInfo.length > 2000 ? \n                            contextInfo.substring(0, 2000) + '...(已截断)' : \n                            contextInfo;\n                            \n                        messages.push({\n                            role: 'system',\n                            content: `File content:\\n${truncatedFileContent}`\n                        });\n                    } else {\n                        // 没有文件时才获取 Office 上下文\n                        try {\n                            const contextData = await getContextInfo();\n                            if (contextData) {\n                                const truncatedContext = contextData.length > 2000 ? \n                                    contextData.substring(0, 2000) + '...(已截断)' : \n                                    contextData;\n                                    \n                                messages.push({\n                                    role: 'system',\n                                    content: `Current context:\\n${truncatedContext}`\n                                });\n                            }\n                        } catch (error) {\n                            console.error('Error getting context:', error);\n                            showError('获取上下文信息失败');\n                            return;\n                        }\n                    }\n                }\n            \n                // 添加历史消息\n                const previousMessages = Array.from(messagesContainer.querySelectorAll('.message'));\n                previousMessages.forEach(msg => {\n                    const role = msg.querySelector('.message-role').textContent;\n                    const content = msg.querySelector('.message-text').textContent;\n            \n                    if (role === '用户') {\n                        messages.push({ \n                            role: 'user', \n                            content: content.substring(0, 8000) // 限制每条消息长度\n                        });\n                    } else if (role === 'DeepSeek') {\n                        messages.push({ \n                            role: 'assistant', \n                            content: content.substring(0, 8000)\n                        });\n                    }\n                });\n            \n                // 添加当前用户消息\n                messages.push({ \n                    role: 'user', \n                    content: message.substring(0, 8000)\n                });\n            \n                // 仅显示用户输入的内容\n                addMessage('user', userMessage);\n            \n                // 清空输入框和文件上传\n                messageInput.value = '';\n                messageInput.style.height = 'auto';\n                sendBtn.disabled = true;\n                fileUpload.value = '';\n                attachedFiles.innerHTML = '';\n                contextInfo = '';\n            \n                // 创建AI响应容器\n                const aiMessageDiv = document.createElement('div');\n                aiMessageDiv.className = 'message';\n                aiMessageDiv.innerHTML = `\n                    <div class=\"avatar\">AI</div>\n                    <div class=\"message-content\">\n                        <div class=\"message-role\">DeepSeek</div>\n                        <div class=\"message-text\" id=\"streamingText\"></div>\n                        <div class=\"message-actions\">\n                            <button class=\"msg-action-btn insert-btn\" title=\"插入到文档\">\n                                 <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#6e6e80\">\n        <path d=\"M19 12H5M5 12l7-7M5 12l7 7\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n    </svg>\n                            </button>\n                            <button class=\"msg-action-btn copy-btn\" title=\"复制内容\">\n                                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#6e6e80\">\n                    <rect x=\"8\" y=\"8\" width=\"12\" height=\"12\" rx=\"2\" stroke-width=\"2\"/>\n                    <path d=\"M16 8V6a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2h2\" stroke-width=\"2\"/>\n                </svg>\n                            </button>\n                        </div>\n                    </div>\n                `;\n            \n                // 在aiMessageDiv添加到messagesContainer后立即绑定事件\n                const actions = aiMessageDiv.querySelector('.message-actions');\n                const msgTextDiv = aiMessageDiv.querySelector('.message-text');\n            \n                if (actions) {\n                    // 插入到文档\n                    actions.querySelector('.insert-btn')?.addEventListener('click', async () => {\n                        const plainText = msgTextDiv.innerText || msgTextDiv.textContent;\n                        if (window.Office && Office.context && Office.context.document) {\n                            try {\n                                if (Office.context.host === Office.HostType.Word && typeof Word !== \"undefined\") {\n                                    await Word.run(async context => {\n                                        context.document.getSelection().insertText(plainText, Word.InsertLocation.replace);\n                                        await context.sync();\n                                    });\n                                } else if (Office.context.host === Office.HostType.Excel && typeof Excel !== \"undefined\") {\n                                    await Excel.run(async context => {\n                                        const range = context.workbook.getSelectedRange();\n                                        range.values = [[plainText]];\n                                        await context.sync();\n                                    });\n                                } else {\n                                    showNotification('当前 Office 类型暂不支持插入', 'error');\n                                }\n                            } catch (e) {\n                                showNotification('插入失败: ' + (e.message || e), 'error');\n                            }\n                        } else {\n                            showNotification('请在 Office 文档中使用插入功能', 'error');\n                        }\n                    });\n            \n                    // 复制内容\n                    actions.querySelector('.copy-btn')?.addEventListener('click', async () => {\n                        const plainText = msgTextDiv.innerText || msgTextDiv.textContent;\n                        try {\n                            await navigator.clipboard.writeText(plainText);\n                            showNotification('内容已复制');\n                        } catch (e) {\n                            showNotification('复制失败: ' + (e.message || e), 'error');\n                        }\n                    });\n                }\n            \n                messagesContainer.appendChild(aiMessageDiv);\n            \n                const streamingText = aiMessageDiv.querySelector('#streamingText');\n                scrollToBottom();\n            \n                // 获取API配置\n                const apiKey = localStorage.getItem('apiKey') || document.getElementById('apiKey').value;\n                const apiEndpoint = localStorage.getItem('apiEndpoint') || document.getElementById('apiEndpoint').value;\n                const model = localStorage.getItem('model') || document.getElementById('model').value;\n                const temperature = localStorage.getItem('temperature') || document.getElementById('temperature').value;\n            \n                if (!apiKey) {\n                    streamingText.innerHTML = '错误: 请先配置API密钥';\n                    return;\n                }\n            \n                // 调用API\n                try {\n                    await callDeepSeekAPI({\n                        apiKey,\n                        apiEndpoint,\n                        model,\n                        temperature: parseFloat(temperature),\n                        messages,  // 包含了上下文和历史消息\n                        streamingText,\n                        onComplete: () => {\n                            // 移除加载动画\n                            gradientBar.classList.remove('loading');\n                            saveCurrentChat();\n                        }\n                    });\n                } catch (error) {\n                    // 发生错误时也要移除加载动画\n                    gradientBar.classList.remove('loading');\n                    console.error('API调用错误:', error);\n                    showError('API请求失败: ' + error.message);\n                }\n            }\n            \n            // 调用DeepSeek API\n            function callDeepSeekAPI({ apiKey, apiEndpoint, model, temperature, messages, streamingText, onComplete }) {\n                const url = apiEndpoint;\n                const headers = {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${apiKey}`\n                };\n                \n                const payload = {\n                    model,\n                    messages,\n                    temperature,\n                    stream: true,\n                    max_tokens: 8000 // 限制响应长度\n                };\n            \n                // 使用fetch实现流式请求\n                fetchDeepSeekAPIStreaming({\n                    url,\n                    headers,\n                    payload,\n                    streamingText,\n                    onComplete\n                });\n            }\n            \n            // 使用fetch API实现流式请求\n            function fetchDeepSeekAPIStreaming({ url, headers, payload, streamingText, onComplete }) {\n                let fullResponse = '';\n                \n                fetch(url, {\n                    method: 'POST',\n                    headers,\n                    body: JSON.stringify(payload)\n                })\n                .then(response => {\n                    if (!response.ok) {\n                        throw new Error(`HTTP error! status: ${response.status}`);\n                    }\n                    \n                    const reader = response.body.getReader();\n                    const decoder = new TextDecoder();\n                    let buffer = '';\n                    \n                    function processChunk({ done, value }) {\n                        if (done) {\n                            // 完成处理\n                            onComplete?.();\n                            return;\n                        }\n                        \n                        buffer += decoder.decode(value, { stream: true });\n                        \n                        // 处理可能的多行\n                        const lines = buffer.split('\\n');\n                        buffer = lines.pop(); // 保留最后不完整的行\n                        \n                        for (const line of lines) {\n                            if (line.startsWith('data:') && !line.includes('[DONE]')) {\n                                try {\n                                    const data = JSON.parse(line.substring(5).trim());\n                                    if (data.choices && data.choices[0].delta.content) {\n                                        const content = data.choices[0].delta.content;\n                                        fullResponse += content;\n                                        \n                                        // 更新消息内容\n                                        streamingText.innerHTML = formatMessage(fullResponse);\n                                        // 实时代码高亮\n                                        streamingText.querySelectorAll('pre code').forEach((block) => {\n                                            hljs.highlightElement(block);\n                                        });\n                                        \n                                        // 滚动到底部\n                                        scrollToBottom();\n                                    }\n                                } catch (e) {\n                                    console.error('Error parsing SSE data:', e);\n                                }\n                            }\n                        }\n                        \n                        // 继续读取\n                        return reader.read().then(processChunk);\n                    }\n                    \n                    return reader.read().then(processChunk);\n                })\n                .catch(error => {\n                    console.error('Error:', error);\n                    streamingText.innerHTML += `<br><br>错误: ${error.message}`;\n                });\n            }\n            \n            // 格式化消息内容（处理代码块等）\n            function formatMessage(text) {\n                marked.setOptions({\n                    breaks: true,\n                    gfm: true,\n                    highlight: function(code, lang) {\n                        if (lang && hljs.getLanguage(lang)) {\n                            return hljs.highlight(code, { language: lang }).value;\n                        }\n                        return hljs.highlightAuto(code).value;\n                    }\n                });\n\n                // 自定义渲染器\n                const renderer = new marked.Renderer();\n                renderer.code = function(code, language) {\n                    const validLang = hljs.getLanguage(language) ? language : 'plaintext';\n                    const highlightedCode = hljs.highlight(code, { language: validLang }).value;\n                    // 运行按钮仅在html语言时显示\n                    let runBtn = '';\n                    if (language === 'html') {\n                        runBtn = `<button class=\"code-action-btn run\">运行</button>`;\n                    } else if (language === 'python') {\n                        // 添加Python运行按钮\n                        runBtn = `<button class=\"code-action-btn run-python\">运行</button>`;\n                    }else if (language === 'javascript') {\n                        runBtn = `<button class=\"code-action-btn run-js\">运行</button>`;\n                    }\n                    return `\n                        <div class=\"code-block\">\n                            <div class=\"code-header\">\n                                <span class=\"code-language\">${language || 'code'}</span>\n                                <div class=\"code-actions\">\n                                    <button class=\"code-action-btn copy\">复制</button>\n                                    ${runBtn}\n                                </div>\n                            </div>\n                            <pre><code class=\"hljs language-${language}\">${highlightedCode}</code></pre>\n                        </div>\n                    `;\n                };\n\n                return marked.parse(text, { renderer });\n            }\n           \n            // 添加消息\n            function addMessage(role, text) {\n                const messageDiv = document.createElement('div');\n                messageDiv.className = 'message';\n\n                let html = formatMessage(text);\n\n                if (role === 'user') {\n                    messageDiv.innerHTML = `\n                        <div class=\"avatar user-avatar\">U</div>\n                        <div class=\"message-content\">\n                            <div class=\"message-role\"></div>\n                            <div class=\"message-text\">${html}</div>\n                        </div>\n                    `;\n                } else {\n                    messageDiv.innerHTML = `\n                        <div class=\"avatar\">AI</div>\n                        <div class=\"message-content\">\n                            <div class=\"message-role\">DeepSeek</div>\n                            <div class=\"message-text\">${html}</div>\n                            <div class=\"message-actions\">\n                                <button class=\"msg-action-btn insert-btn\" title=\"插入到文档\">\n                                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n                                        <path d=\"M12 3v12m0 0l-4-4m4 4l4-4\" stroke=\"#10a37f\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n                                        <rect x=\"4\" y=\"17\" width=\"16\" height=\"4\" rx=\"2\" fill=\"#10a37f\" opacity=\"0.15\"/>\n                                    </svg>\n                                </button>\n                                <button class=\"msg-action-btn copy-btn\" title=\"复制内容\">\n                                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n                                        <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" stroke=\"#6e6e80\" stroke-width=\"2\"/>\n                                        <rect x=\"2\" y=\"2\" width=\"13\" height=\"13\" rx=\"2\" fill=\"#6e6e80\" opacity=\"0.12\"/>\n                                    </svg>\n                                </button>\n                            </div>\n                        </div>\n                    `;\n                }\n\n                messagesContainer.appendChild(messageDiv);\n\n                // 实时代码高亮\n                messageDiv.querySelectorAll('pre code').forEach((block) => {\n                    hljs.highlightElement(block);\n                });\n\n                // 事件绑定\n                if (role !== 'user') {\n                    const actions = messageDiv.querySelector('.message-actions');\n                    const msgTextDiv = messageDiv.querySelector('.message-text');\n                    // 插入到文档\n                    actions.querySelector('.insert-btn').onclick = async () => {\n                        const plainText = msgTextDiv.innerText || msgTextDiv.textContent;\n                        if (window.Office && Office.context && Office.context.document) {\n                            try {\n                                if (Office.context.host === Office.HostType.Word && typeof Word !== \"undefined\") {\n                                    await Word.run(async context => {\n                                        context.document.getSelection().insertText(plainText, Word.InsertLocation.replace);\n                                        await context.sync();\n                                    });\n                                } else if (Office.context.host === Office.HostType.Excel && typeof Excel !== \"undefined\") {\n                                    await Excel.run(async context => {\n                                        const range = context.workbook.getSelectedRange();\n                                        range.values = [[plainText]];\n                                        await context.sync();\n                                    });\n                                } else {\n                                    showNotification('当前 Office 类型暂不支持插入', 'error');\n                                }\n                            } catch (e) {\n                                showNotification('插入失败: ' + (e.message || e), 'error');\n                            }\n                        } else {\n                            showNotification('请在 Office 文档中使用插入功能', 'error');\n                        }\n                    };\n                    // 复制内容\n                    actions.querySelector('.copy-btn').onclick = async () => {\n                        const plainText = msgTextDiv.innerText || msgTextDiv.textContent;\n                        try {\n                            await navigator.clipboard.writeText(plainText);\n                            showNotification('内容已复制');\n                        } catch (e) {\n                            showNotification('复制失败: ' + (e.message || e), 'error');\n                        }\n                    };\n                }\n\n                return messageDiv;\n            }\n            \n            // 滚动到底部\n            function scrollToBottom() {\n                messagesContainer.scrollTop = messagesContainer.scrollHeight;\n            }\n\n            const contextEyeBtn = document.getElementById('contextEyeBtn');\n            let contextInfo = \"\";\n            const eyeIcon = document.getElementById('eyeIcon');\n            let contextEnabled = false; // 是否开启上下文感知\n\n            contextEyeBtn.addEventListener('click', function() {\n                contextEnabled = !contextEnabled;\n                if (contextEnabled) {\n                    // 开眼图标\n                    eyeIcon.innerHTML = `\n                        <path d=\"M1 12C2.73 7.61 7.11 4 12 4s9.27 3.61 11 8c-1.73 4.39-6.11 8-11 8S2.73 16.39 1 12z\" stroke=\"currentColor\" stroke-width=\"2\" fill=\"none\"/>\n                        <circle cx=\"12\" cy=\"12\" r=\"3\" stroke=\"currentColor\" stroke-width=\"2\" fill=\"none\"/>\n                        <circle cx=\"12\" cy=\"12\" r=\"1.5\" fill=\"currentColor\"/>\n                    `;\n                    contextEyeBtn.style.background = \"transparent\";\n                    contextEyeBtn.style.color = \"var(--primary-color)\";\n                    contextEyeBtn.title = \"已开启上下文感知\";\n                } else {\n                    // 闭眼图标\n                    eyeIcon.innerHTML = `\n                        <path d=\"M1 12C2.73 7.61 7.11 4 12 4s9.27 3.61 11 8c-1.73 4.39-6.11 8-11 8S2.73 16.39 1 12z\" stroke=\"currentColor\" stroke-width=\"2\" fill=\"none\"/>\n                        <circle cx=\"12\" cy=\"12\" r=\"3\" stroke=\"currentColor\" stroke-width=\"2\" fill=\"none\"/>\n                        <line x1=\"4\" y1=\"20\" x2=\"20\" y2=\"4\" stroke=\"currentColor\" stroke-width=\"2\"/>\n                    `;\n                    contextEyeBtn.style.background = \"transparent\";\n                    contextEyeBtn.style.color = \"var(--primary-color)\";\n                    contextEyeBtn.title = \"开启上下文感知\";\n                }\n            });\n        });\n        \n        function showError(message) {\n            // 检查是否已有错误提示，避免重复\n            if (document.querySelector('.alert-danger')) return;\n            const errorDiv = document.createElement('div');\n            errorDiv.className = 'alert alert-danger';\n            errorDiv.textContent = message;\n            // 插入到输入区上方\n            const inputContainer = document.querySelector('.input-container');\n            inputContainer.parentNode.insertBefore(errorDiv, inputContainer);\n            setTimeout(() => errorDiv.remove(), 4000);\n        }\n\n        // 添加一个通知函数\n        function showNotification(message, type = 'success') {\n            const notification = document.createElement('div');\n            notification.className = `notification notification-${type}`;\n            notification.style.cssText = `\n                position: fixed;\n                top: 50px;\n                right: 150px;\n                padding: 12px 24px;\n                background: ${type === 'success' ? '#10a37f' : '#dc3545'};\n                color: white;\n                border-radius: 4px;\n                box-shadow: 0 2px 8px rgba(0,0,0,0.2);\n                z-index: 1000;\n                animation: slideIn 0.3s ease;\n            `;\n            notification.textContent = message;\n            document.body.appendChild(notification);\n\n            // 3秒后自动消失\n            setTimeout(() => {\n                notification.style.animation = 'slideOut 0.3s ease';\n                setTimeout(() => notification.remove(), 300);\n            }, 3000);\n        }\n\n        // 在样式部分添加动画\n        const style = document.createElement('style');\n        style.textContent = `\n            @keyframes slideIn {\n                from { transform: translateX(100%); opacity: 0; }\n                to { transform: translateX(0); opacity: 1; }\n            }\n            @keyframes slideOut {\n                from { transform: translateX(0); opacity: 1; }\n                to { transform: translateX(100%); opacity: 0; }\n            }\n        `;\n        document.head.appendChild(style);\n        const jupyterConfig = {\n        baseUrl: 'https://localhost:8888/execute', // Jupyter 服务器地址\n        token: '', // 你的 Jupyter token\n        kernelName: 'python3' // Python 内核名称\n    };\n        // 运行Python代码的函数\n        async function runPythonCode(code, messageContent) {\n// 显示加载状态\n    const loadingDiv = document.createElement('div');\n    loadingDiv.className = 'python-result loading';\n    loadingDiv.innerHTML = '<strong>正在运行...</strong>';\n    messageContent.appendChild(loadingDiv);\n\n    try {\n        // 添加重试逻辑\n        let retries = 3;\n        let response;\n        \n        while (retries > 0) {\n            try {\n                response = await fetch('https://localhost:8888/execute', {\n                    method: 'POST',\n                    headers: { \n                        'Content-Type': 'application/json',\n                        'Accept': 'application/json'\n                    },\n                    credentials: 'include', // 包含凭证\n                    body: JSON.stringify({ \n                        code,\n                        timestamp: Date.now() // 添加时间戳避免缓存\n                    }),\n                });\n                break; // 如果成功则跳出循环\n            } catch (e) {\n                retries--;\n                if (retries === 0) throw e;\n                console.warn(`请求失败，剩余重试次数: ${retries}`, e);\n                await new Promise(resolve => setTimeout(resolve, 1000)); // 等待1秒后重试\n            }\n        }\n\n        if (!response.ok) {\n            const errorText = await response.text();\n            throw new Error(`HTTP错误! 状态码: ${response.status}, 响应: ${errorText}`);\n        }\n\n        const result = await response.json();\n        loadingDiv.remove();\n\n        if (result.success) {\n            messageContent.innerHTML += `\n                <div class=\"python-result\">\n                    <strong>输出:</strong>\n                    <pre><code class=\"hljs language-plaintext\">${escapeHtml(result.output) || '[无输出]'}</code></pre>\n                </div>\n            `;\n        } else {\n            messageContent.innerHTML += `\n                <div class=\"python-result error\">\n                    <strong>错误:</strong>\n                    <pre><code class=\"hljs language-plaintext\">${escapeHtml(result.error)}</code></pre>\n                </div>\n            `;\n        }\n    } catch (error) {\n        const errorMessage = error.message || '未知错误';\n        const errorStack = error.stack || '无堆栈信息';\n\n        // 检查是否有 HTTP 响应对象\n        let statusCode = '未知';\n        let responseText = '无响应内容';\n        if (error.response) {\n            statusCode = error.response.status || '未知状态码';\n            responseText = error.response.statusText || '无状态文本';\n        }\n\n        console.error('Python执行错误:', {\n            message: errorMessage,\n            stack: errorStack,\n            request: {\n                url: 'https://localhost:8888/execute',\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json'\n                },\n                body: {\n                    code,\n                    timestamp: Date.now()\n                }\n            },\n            response: {\n                status: statusCode,\n                text: responseText\n            }\n        });\n\n        // 移除加载状态\n        loadingDiv.remove();\n\n        // 显示详细错误信息\n        messageContent.innerHTML += `\n            <div class=\"python-result error\">\n                <strong>请求失败:</strong> ${escapeHtml(errorMessage)}<br>\n                <small>请确保Python后端服务器正在运行。</small><br>\n                <details>\n                    <summary>详细信息</summary>\n                    <pre>状态码: ${escapeHtml(statusCode)}\\n响应内容: ${escapeHtml(responseText)}\\n堆栈信息: ${escapeHtml(errorStack)}</pre>\n                </details>\n            </div>\n        `;\n    }\n    hljs.highlightAll();\n}\n\n// 添加HTML转义函数\nfunction escapeHtml(text) {\n    if (typeof text !== 'string') {\n        text = String(text || ''); // 将非字符串转换为字符串，默认值为空字符串\n    }\n    return text\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\"/g, \"&quot;\")\n        .replace(/'/g, \"&#039;\");\n}\n\n// 添加运行 Office.js 代码的函数\nasync function runOfficeJSCode(code, messageContent) {\n    // 显示加载状态\n    const loadingDiv = document.createElement('div');\n    loadingDiv.className = 'python-result loading';\n    loadingDiv.innerHTML = '<strong>正在运行...</strong>';\n    messageContent.appendChild(loadingDiv);\n\n    try {\n        // 检查是否在 Office 环境中\n        if (!window.Office) {\n            throw new Error('当前不在 Office 环境中，无法执行 Office.js 代码');\n        }\n\n        // 等待 Office.js 初始化\n        await new Promise((resolve) => {\n            if (Office.context.host) {\n                resolve();\n            } else {\n                Office.onReady(resolve);\n            }\n        });\n        // 执行代码并获取结果\n        const result = await eval(`\n            (async () => {\n                try {\n                    ${code}\n                    return \"success\"; // 默认返回成功\n                } catch (e) {\n                    throw e;\n                }\n            })()\n        `);\n\n        loadingDiv.remove();\n\n        // 根据主机类型显示不同的成功消息\n        let successMessage = '执行成功!';\n        if (Office.context.host === Office.HostType.Excel) {\n            successMessage += '<br>请检查Excel工作表以查看图表效果。';\n        }\n\n        // 显示成功消息\n        messageContent.innerHTML += `\n            <div class=\"python-result\">\n                <strong>${successMessage}</strong>\n            </div>\n        `;\n\n        // 触发重新渲染\n        if (Office.context.host === Office.HostType.Excel) {\n            await Excel.run(async (context) => {\n                context.workbook.worksheets.getActiveWorksheet().getUsedRange().format.load(\"background\");\n                await context.sync();\n            });\n        }\n    } catch (error) {\n        // 移除加载状态\n        loadingDiv.remove();\n\n        // 显示错误信息\n        messageContent.innerHTML += `\n            <div class=\"python-result error\">\n                <strong>执行出错:</strong>\n                <pre><code class=\"hljs language-plaintext\">${escapeHtml(error.message)}</code></pre>\n            </div>\n        `;\n    }\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"zh-CN\\\"> <head> <meta charset=\\\"UTF-8\\\"> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>DeepSeek Chat</title> <link rel=\\\"stylesheet\\\" href=\\\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css\\\"> <style>:root{--primary-color:#6e6e80;--secondary-color:#acacbe;--bg-color:#f7f7f8;--sidebar-bg:#f0f0f0;--message-bg:#ffffff;--user-message-bg:#f0f0f0;--border-color:#e5e5e6;--button-bg:#10a37f;--button-hover:#0d8a6a;--code-bg:#f6f8fa}*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif}body{background-color:var(--bg-color);color:#333;display:flex;height:100vh;overflow:hidden}.sidebar{width:260px;background-color:var(--sidebar-bg);border-right:1px solid var(--border-color);display:flex;flex-direction:column;height:100vh;transition:transform .3s ease}.sidebar-header{padding:15px;border-bottom:1px solid var(--border-color)}.new-chat-btn{width:100%;padding:10px;background-color:var(--button-bg);color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;transition:background-color .2s}.new-chat-btn:hover{background-color:var(--button-hover)}.history-list{flex:1;overflow-y:auto;padding:10px 0}.history-item{padding:10px 15px;cursor:pointer;border-radius:5px;margin:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.history-item:hover{background-color:rgba(0,0,0,.05)}.history-item.active{background-color:rgba(0,0,0,.1)}.sidebar-footer{padding:15px;border-top:1px solid var(--border-color)}.user-profile{display:flex;align-items:center;gap:10px}.user-avatar{width:25px;height:25px;border-radius:50%;background-color:#ddd;display:flex;align-items:center;justify-content:center;font-weight:700}.user-name{font-weight:300}.main-content{flex:1;display:flex;flex-direction:column;height:100vh;position:relative}.chat-header{padding:15px;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between}.chat-title{font-weight:600;font-size:16px}.api-config-btn{background:0 0;border:none;cursor:pointer;color:var(--primary-color);font-size:14px;display:flex;align-items:center;gap:5px}.api-config-btn:hover{color:#000}.messages-container{flex:1;overflow-y:auto;padding:20px 0;scroll-behavior:smooth;display:flex;flex-direction:column;align-items:center}.message{width:85%;max-width:800px;margin-left:0;margin-right:0;box-sizing:border-box}.avatar{width:25px;height:25px;border-radius:50%;background-color:#10a37f;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;flex-shrink:0}.user-avatar{background-color:#6e6e80}.message-content{flex:1;padding-top:5px}.message-role{font-weight:600;margin-bottom:5px}.message-text{line-height:1.6}.message-text p{margin-bottom:1em}.message-text p:last-child{margin-bottom:0}.message-text{background:#fafbfc;border-radius:6px;padding:16px 18px;margin:8px 0;line-height:1.7;word-break:break-word;font-size:15px;box-sizing:border-box}pre,pre code{white-space:pre-wrap!important;word-break:break-all;overflow-x:hidden!important;margin:0;padding:16px;background-color:var(--code-bg);border-radius:6px}.code-block{margin:10px 0 20px 0;background:var(--code-bg);border-radius:6px;overflow:hidden;box-shadow:0 1px 4px rgba(0,0,0,.03);padding:0}.code-header{width:100%;display:flex;justify-content:space-between;align-items:center;font-family:monospace;font-size:14px;color:#666;background:#f0f0f0;padding:0 16px;height:36px;border-bottom:1px solid #e5e5e6;box-sizing:border-box;margin:0}.code-block pre,.code-block pre code{margin:0;padding:16px;background:0 0;border-radius:0;white-space:pre-wrap!important;word-break:break-all;overflow-x:auto;font-size:15px;box-sizing:border-box}.code-block pre{margin:0;padding:16px;background:0 0;border-radius:0 0 6px 6px}.code-actions{display:flex;gap:4px;margin:0}.code-action-btn{background:0 0;border:none;color:#666;cursor:pointer;font-size:13px;padding:2px 8px;border-radius:4px;margin:0;transition:background .2s,color .2s}.code-action-btn.copy:hover{color:var(--button-bg);background:#e0f7f0}.code-action-btn.run:hover{color:#007bff;background:#e6f0fa}.message-text p:last-child{margin-bottom:0}.input-container{padding:20px;border-top:1px solid var(--border-color);background-color:var(--message-bg)}.input-box{max-width:800px;margin:0 auto;position:relative}.textarea-container{position:relative}.message-input{border-bottom-width:0!important;width:100%;min-height:70px;max-height:200px;padding:12px 50px 12px 15px;border:1px solid var(--border-color);border-radius:8px;resize:none;font-size:15px;line-height:1.5;outline:0;background-color:var(--message-bg);color:#333;transition:border-color .3s ease,box-shadow .3s ease}.message-input:focus{border-color:transparent!important;box-shadow:0 0 0 2px rgba(16,163,127,.1)}.input-actions{position:absolute;right:10px;bottom:10px;display:flex;gap:8px}.file-upload-btn,.send-btn{width:32px;height:32px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background-color:var(--button-bg);color:#fff;transition:background-color .2s}.file-upload-btn{background-color:transparent;color:var(--primary-color)}.file-upload-btn:hover{background-color:rgba(0,0,0,.05)}.send-btn:hover{background-color:var(--button-hover)}.send-btn:disabled{background-color:var(--secondary-color);cursor:not-allowed}.send-btn{width:40px;height:40px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--button-bg) 60%,#13c296 100%);color:#fff;font-size:18px;transition:background .2s,box-shadow .2s,transform .1s;box-shadow:0 2px 8px rgba(16,163,127,.1);outline:0}.send-btn:enabled:hover{background:linear-gradient(135deg,var(--button-hover) 60%,#13c296 100%);box-shadow:0 4px 16px rgba(16,163,127,.18);transform:translateY(-2px) scale(1.07)}.send-btn:enabled:active{background:linear-gradient(135deg,var(--button-bg) 60%,#13c296 100%);box-shadow:0 2px 8px rgba(16,163,127,.1);transform:scale(.97)}.send-btn:disabled svg{color:#acacbe}.send-btn:disabled{background:0 0;color:var(--secondary-color);cursor:not-allowed;opacity:.5;transform:none;box-shadow:none}.send-btn{width:32px;height:32px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background:0 0;color:var(--button-bg);font-size:18px;transition:transform .2s;padding:0;outline:0}.send-btn:enabled:hover{transform:translateX(2px);color:var(--button-hover)}.send-btn:enabled:active{transform:scale(.95)}.send-btn:disabled{color:var(--secondary-color);cursor:not-allowed;opacity:.7}.send-btn svg{width:24px;height:24px}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .3s}.modal-overlay.active{opacity:1;pointer-events:all}.modal{background-color:#fff;border-radius:8px;width:500px;max-width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 4px 20px rgba(0,0,0,.15);transform:translateY(20px);transition:transform .3s}.modal-overlay.active .modal{transform:translateY(0)}.modal-header{padding:16px 20px;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between}.modal-title{font-weight:600;font-size:18px}.modal-close-btn{background:0 0;border:none;font-size:20px;cursor:pointer;color:var(--secondary-color)}.modal-body{padding:20px}.form-group{margin-bottom:20px}.form-label{display:block;margin-bottom:8px;font-weight:500}.form-input{width:100%;padding:10px 12px;border:1px solid var(--border-color);border-radius:4px;font-size:14px}.form-input:focus{border-color:var(--button-bg);outline:0;box-shadow:0 0 0 2px rgba(16,163,127,.2)}.modal-footer{padding:16px 20px;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:10px}.btn{padding:8px 16px;border-radius:4px;font-weight:500;cursor:pointer;transition:background-color .2s}.btn-primary{background-color:var(--button-bg);color:#fff;border:none}.btn-primary:hover{background-color:var(--button-hover)}.btn-secondary{background-color:transparent;border:1px solid var(--border-color)}.btn-secondary:hover{background-color:rgba(0,0,0,.05)}.typing-cursor{display:inline-block;width:8px;height:16px;background-color:#333;vertical-align:middle;margin-left:2px;animation:blink 1s infinite}@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}.file-input{display:none}.attached-files{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px}.file-tag{background-color:#e9e9eb;padding:6px 12px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:8px;max-width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-tag.error{background-color:#fee2e2;color:#dc3545}.html-preview-modal{position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff;z-index:1001;display:none;flex-direction:column}.html-preview-modal.active{display:flex}.preview-header{padding:12px 20px;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center}.preview-title{font-weight:600}.preview-close{background:0 0;border:none;font-size:20px;cursor:pointer}.preview-content{flex:1;border:none;width:100%}@media (max-width:768px){.sidebar{position:absolute;z-index:100;transform:translateX(-100%)}.sidebar.active{transform:translateX(0)}.message{max-width:100%}}@media (max-width:900px){.message{max-width:98vw}}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:rgba(0,0,0,.05)}::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2);border-radius:4px}::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.3)}.messages-container::-webkit-scrollbar,pre code::-webkit-scrollbar,pre::-webkit-scrollbar{height:0!important;width:8px}pre,pre code{scrollbar-width:thin;scrollbar-color:#e5e5e6 #f6f8fa}.context-btn-container{position:absolute;left:8px;bottom:10px;z-index:2;display:flex;align-items:flex-end}.context-eye-btn{width:30px;height:30px;border-radius:50%;border:none;background:0 0;color:var(--secondary-color);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:color .2s,transform .2s;padding:0;outline:0}.context-eye-btn:hover{color:var(--primary-color);transform:scale(1.08);background:0 0}.python-result{margin-top:10px;padding:10px;background:#f8f9fa;border-radius:4px;border-left:4px solid #10a37f}.python-result.error{border-left-color:#dc3545}.python-result.loading{border-left-color:#ffc107;animation:pulse 1.5s infinite}@keyframes pulse{0%{opacity:.6}50%{opacity:1}100%{opacity:.6}}.message-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:8px}.msg-action-btn{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:50%;transition:background .2s;display:inline-flex;align-items:center;justify-content:center}.msg-action-btn:hover{background:#e0f7f0}.msg-action-btn.insert-btn:focus svg path,.msg-action-btn.insert-btn:hover svg path{stroke:#13c296}.msg-action-btn.copy-btn:focus svg rect,.msg-action-btn.copy-btn:hover svg rect{stroke:#10a37f}.textarea-container{position:relative;margin-bottom:0}.gradient-bar{position:absolute;bottom:0;left:0;width:100%;height:5px;background:linear-gradient(to right,#00ff87,#0fe,#00a8ff,#9f5afd,#ff2d95,#00ff87);background-size:200% 100%;opacity:.8;transform:scaleX(1);transform-origin:left;transition:opacity .3s ease;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.gradient-bar.loading{transform:scaleX(1);animation:gradientSlide .8s linear infinite}@keyframes gradientSlide{0%{background-position:100% 0}100%{background-position:-100% 0}}.code-action-btn.run-js:hover{color:#0078d4;background:#e5f1fb}.code-action-btn.run-js{margin-left:4px}.prompt-container{position:relative;margin-bottom:10px}.prompt-toggle-btn{display:flex;align-items:center;gap:6px;padding:6px 12px;border:1px solid var(--border-color);border-radius:6px;background:#fff;color:var(--primary-color);cursor:pointer;font-size:14px;transition:all .2s}.prompt-toggle-btn:hover{background:var(--bg-color);border-color:var(--primary-color)}.prompt-list{position:absolute;bottom:100%;left:0;width:100%;max-height:0;overflow:hidden;background:#fff;border-radius:8px;box-shadow:0 -4px 20px rgba(0,0,0,.1);transition:all .3s ease;z-index:100}.prompt-list.active{max-height:400px;padding:16px;margin-bottom:8px;overflow-y:auto}.prompt-category{margin-bottom:16px}.prompt-category h3{font-size:14px;color:var(--primary-color);margin-bottom:8px;font-weight:600}.prompt-items{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px}.prompt-item{padding:8px 12px;background:var(--bg-color);border:1px solid var(--border-color);border-radius:4px;font-size:13px;color:var(--primary-color);cursor:pointer;text-align:left;transition:all .2s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.prompt-item:hover{background:#f0f0f0;border-color:var(--primary-color)}</style> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://unpkg.com/@jupyterlab/services@6.4.4/dist/index.umd.js\\\"><\" + \"/script> </head> <body> <div class=\\\"sidebar\\\"> <div class=\\\"sidebar-header\\\"> <button class=\\\"new-chat-btn\\\" id=\\\"newChatBtn\\\"> <svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"> <path d=\\\"M12 4V20M4 12H20\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\"/> </svg> 新聊天 </button> </div> <div class=\\\"history-list\\\" id=\\\"historyList\\\"> </div> <div class=\\\"sidebar-footer\\\"> <div class=\\\"user-profile\\\"> <div class=\\\"user-avatar\\\">U</div> <div class=\\\"user-name\\\"></div> </div> </div> </div> <div class=\\\"main-content\\\"> <div class=\\\"chat-header\\\"> <div class=\\\"chat-title\\\" id=\\\"chatTitle\\\">新聊天</div> <button class=\\\"api-config-btn\\\" id=\\\"apiConfigBtn\\\"> ⚙️ API 配置 </button> </div> <div class=\\\"messages-container\\\" id=\\\"messagesContainer\\\"> </div> <div class=\\\"prompt-container\\\"> <button class=\\\"prompt-toggle-btn\\\" id=\\\"promptToggleBtn\\\" title=\\\"提示词列表\\\"> <svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\"> <path d=\\\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\\\" stroke-width=\\\"2\\\"/> </svg> 提示词 </button> <div class=\\\"prompt-list\\\" id=\\\"promptList\\\"> <div class=\\\"prompt-category\\\"> <h3>常用提示词</h3> <div class=\\\"prompt-items\\\"> <button class=\\\"prompt-item\\\">帮我修改这段代码的错误</button> <button class=\\\"prompt-item\\\">解释这段代码的功能</button> <button class=\\\"prompt-item\\\">优化这段代码的性能</button> <button class=\\\"prompt-item\\\">帮我生成单元测试</button> </div> </div> <div class=\\\"prompt-category\\\"> <h3>文档处理</h3> <div class=\\\"prompt-items\\\"> <button class=\\\"prompt-item\\\">分析这份文档的主要内容</button> <button class=\\\"prompt-item\\\">总结这份文档的要点</button> <button class=\\\"prompt-item\\\">检查文档的错误</button> <button class=\\\"prompt-item\\\">根据当前工作表数据用Office.js在新的工作表......，要求：优先使用传统的 Promise 链式写法替代 async/await</button> </div> </div> </div> </div> <div class=\\\"input-container\\\"> <div class=\\\"input-box\\\"> <div class=\\\"textarea-container\\\"> <div class=\\\"context-btn-container\\\"> <button class=\\\"context-eye-btn\\\" id=\\\"contextEyeBtn\\\" title=\\\"开启上下文感知\\\"> <svg id=\\\"eyeIcon\\\" width=\\\"22\\\" height=\\\"22\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\"> <path d=\\\"M1 12C2.73 7.61 7.11 4 12 4s9.27 3.61 11 8c-1.73 4.39-6.11 8-11 8S2.73 16.39 1 12z\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\"/> <circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"3\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\"/> <line x1=\\\"4\\\" y1=\\\"20\\\" x2=\\\"20\\\" y2=\\\"4\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"/> </svg> </button> </div> <textarea class=\\\"message-input\\\" id=\\\"messageInput\\\" placeholder=\\\"输入消息...\\\" rows=\\\"1\\\"></textarea> <div class=\\\"gradient-bar\\\" id=\\\"gradientBar\\\"></div> <div class=\\\"input-actions\\\"> <label for=\\\"fileUpload\\\" class=\\\"file-upload-btn\\\" title=\\\"上传文件\\\"> <svg width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\"> <path d=\\\"M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l8.57-8.57A4 4 0 1118.54 9.4l-8.57 8.57a2 2 0 11-2.83-2.83l8.49-8.48\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/> </svg> </label> <input type=\\\"file\\\" id=\\\"fileUpload\\\" class=\\\"file-input\\\" multiple=\\\"multiple\\\"> <button class=\\\"send-btn\\\" id=\\\"sendBtn\\\" disabled=\\\"disabled\\\" title=\\\"发送\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"> <path d=\\\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\\\"/> </svg> </button> </div> </div> <div class=\\\"attached-files\\\" id=\\\"attachedFiles\\\"></div> </div> </div> </div> <div class=\\\"modal-overlay\\\" id=\\\"apiConfigModal\\\"> <div class=\\\"modal\\\"> <div class=\\\"modal-header\\\"> <div class=\\\"modal-title\\\">✏️API 配置</div> <button class=\\\"modal-close-btn\\\" id=\\\"closeApiConfigModal\\\">&times;</button> </div> <div class=\\\"modal-body\\\"> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\" for=\\\"apiKey\\\">API 密钥</label> <input type=\\\"password\\\" class=\\\"form-input\\\" id=\\\"apiKey\\\" placeholder=\\\"输入您的API密钥\\\"> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\" for=\\\"apiEndpoint\\\">API 端点</label> <input type=\\\"text\\\" class=\\\"form-input\\\" id=\\\"apiEndpoint\\\" placeholder=\\\"https://api.siliconflow.cn/v1/chat/completions\\\"> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\" for=\\\"model\\\">模型</label> <select class=\\\"form-input\\\" id=\\\"model\\\"> <option value=\\\"deepseek-ai/DeepSeek-V3\\\">DeepSeek V3</option> <option value=\\\"deepseek-ai/DeepSeek-R1\\\">DeepSeek R1</option> <option value=\\\"Pro/deepseek-ai/DeepSeek-V3\\\">Pro/DeepSeek-V3</option> <option value=\\\"Pro/deepseek-ai/DeepSeek-R1\\\">Pro/DeepSeek R1</option> <option value=\\\"Qwen/Qwen3-32B\\\">Qwen/Qwen3-32B</option> <option value=\\\"Qwen/Qwen3-14B\\\">Qwen/Qwen3-14B</option> </select> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\" for=\\\"temperature\\\">温度 (0-2)</label> <input type=\\\"range\\\" class=\\\"form-input\\\" id=\\\"temperature\\\" min=\\\"0\\\" max=\\\"2\\\" step=\\\"0.1\\\" value=\\\"0.7\\\"> <span id=\\\"temperatureValue\\\">0.7</span> </div> </div> <div class=\\\"modal-footer\\\"> <button class=\\\"btn btn-secondary\\\" id=\\\"cancelApiConfig\\\">取消</button> <button class=\\\"btn btn-primary\\\" id=\\\"saveApiConfig\\\">保存</button> </div> </div> </div> <div class=\\\"html-preview-modal\\\" id=\\\"htmlPreviewModal\\\"> <div class=\\\"preview-header\\\"> <div class=\\\"preview-title\\\">HTML 预览</div> <button class=\\\"preview-close\\\" id=\\\"closePreviewModal\\\">&times;</button> </div> <iframe class=\\\"preview-content\\\" id=\\\"htmlPreviewFrame\\\"></iframe> </div> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/html.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"><\" + \"/script> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","r","t","n","Symbol","iterator","a","asyncIterator","u","toStringTag","c","defineProperty","value","enumerable","configurable","writable","h","Generator","create","done","method","arg","delegate","d","f","sent","_sent","dispatchException","abrupt","s","type","Context","wrap","GeneratorFunction","GeneratorFunctionPrototype","l","getPrototypeOf","y","x","v","forEach","_invoke","AsyncIterator","_typeof","resolve","__await","then","return","TypeError","next","w","tryEntries","push","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","unshift","pop","values","prev","charAt","slice","stop","rval","complete","finish","catch","delegateYield","_createForOfIteratorHelper","Array","isArray","_unsupportedIterableToArray","_n","F","_arrayLikeToArray","toString","from","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","getContextInfo","_getContextInfo","_callee13","_context13","Office","context","host","HostType","Excel","run","_ref13","_callee11","sheet","usedRange","sheetName","workbookName","_context11","workbook","worksheets","getActiveWorksheet","load","getUsedRange","sync","concat","address","rowCount","columnCount","JSON","stringify","_x1","t0","message","Word","_ref14","_callee12","selection","_context12","getSelection","text","_x10","t1","showError","querySelector","errorDiv","createElement","className","textContent","inputContainer","parentNode","insertBefore","setTimeout","remove","showNotification","notification","style","cssText","body","appendChild","animation","onReady","info","console","log","addEventListener","hljs","highlightAll","messageInput","getElementById","sendBtn","fileUpload","attachedFiles","messagesContainer","apiConfigBtn","apiConfigModal","closeApiConfigModal","cancelApiConfig","saveApiConfig","temperature","temperatureValue","newChatBtn","historyList","chatTitle","promptToggleBtn","promptList","classList","toggle","querySelectorAll","item","prompt","height","scrollHeight","disabled","focus","contains","target","currentChatId","generateChatId","chatHistory","readFileContent","file","reject","includes","endsWith","reader","FileReader","onload","_ref2","_callee2","data","result","_context2","Uint8Array","XLSX","read","SheetNames","worksheet","Sheets","jsonData","utils","sheet_to_json","header","map","row","join","error","_x","onerror","readAsArrayBuffer","_ref3","_callee3","arrayBuffer","extractedText","formattedText","documentInfo","_context3","mammoth","extractRawText","trim","_x2","readAsText","Date","now","updateHistoryList","innerHTML","reverse","chatId","chat","historyItem","title","saveCurrentChat","loadChat","add","messages","role","content","substring","localStorage","setItem","msg","messageDiv","scrollToBottom","block","highlightElement","sendMessage","_sendMessage","_callee10","gradientBar","userMessage","truncatedFileContent","contextData","truncatedContext","aiMessageDiv","actions","msgTextDiv","_actions$querySelecto","_actions$querySelecto2","streamingText","apiKey","apiEndpoint","model","_context10","contextEnabled","contextInfo","addMessage","_callee0","plainText","_context0","innerText","_ref10","_callee8","_context8","insertText","InsertLocation","_x5","_ref11","_callee9","_context9","getSelectedRange","_x6","_callee1","_context1","navigator","clipboard","writeText","getItem","callDeepSeekAPI","parseFloat","onComplete","_ref4","_ref5","payload","fullResponse","fetch","url","headers","response","ok","status","getReader","decoder","TextDecoder","buffer","processChunk","_ref6","lines","decode","stream","split","_step2","_iterator2","line","startsWith","parse","choices","delta","formatMessage","err","fetchDeepSeekAPIStreaming","max_tokens","marked","setOptions","breaks","gfm","highlight","code","lang","getLanguage","language","highlightAuto","renderer","Renderer","validLang","highlightedCode","runBtn","html","onclick","_callee6","_context6","_ref8","_callee4","_context4","_x3","_ref9","_callee5","_context5","_x4","_callee7","_context7","scrollTop","savedHistory","chatIds","initChatHistory","_callee","fileContents","loadingTag","_iterator","_step","fileTag","_context","files","removeChild","color","fileName","getAttribute","filter","dataTransfer","DataTransfer","items","parentElement","temp","codeBlock","closest","originalText","stopPropagation","htmlPreviewFrame","blob","Blob","URL","createObjectURL","runPythonCode","runOfficeJSCode","key","shiftKey","preventDefault","contextEyeBtn","eyeIcon","background","head","jupyterConfig","baseUrl","token","kernelName","_x7","_x8","_runPythonCode","_callee14","messageContent","loadingDiv","retries","errorText","errorMessage","errorStack","statusCode","responseText","_context14","credentials","timestamp","warn","json","success","escapeHtml","output","stack","statusText","request","String","_x9","_x0","_runOfficeJSCode","_callee16","successMessage","_callee16$","_context16","eval","_ref15","_callee15","_context15","format","_x11"],"sourceRoot":""}